2025-11-04 14:56:13,323 [INFO] __main__: ðŸš€ Starting ETL pipeline: company -> employee_trends_test. Workers=20, BatchSize=500
2025-11-04 14:56:14,916 [INFO] __main__: âœ… Connected to MongoDB. DB: 'leadcruit'. Source: 'company', Target: 'employee_trends_test'
2025-11-04 14:56:14,917 [INFO] __main__: Ensuring indexes on target collection 'employee_trends_test'...
2025-11-04 14:56:15,744 [INFO] __main__: Indexes ensured.
2025-11-04 14:56:15,745 [INFO] __main__: Starting full refresh/upsert from 'company'...
2025-11-04 14:56:22,409 [INFO] __main__: Processing batch of 500 companies...
2025-11-04 14:56:25,223 [INFO] __main__: Performing bulk upsert of 500 documents...
2025-11-04 14:56:26,955 [INFO] __main__: âœ… Bulk upsert complete: Inserted=500, Updated=0
2025-11-04 14:56:32,736 [INFO] __main__: Processing batch of 500 companies...
2025-11-04 14:56:35,584 [INFO] __main__: Performing bulk upsert of 500 documents...
2025-11-04 14:56:36,696 [INFO] __main__: âœ… Bulk upsert complete: Inserted=500, Updated=0
2025-11-04 14:56:42,957 [INFO] __main__: Processing batch of 500 companies...
2025-11-04 14:56:46,149 [INFO] __main__: Performing bulk upsert of 500 documents...
2025-11-04 14:56:47,168 [INFO] __main__: âœ… Bulk upsert complete: Inserted=500, Updated=0
2025-11-04 14:56:50,666 [INFO] __main__: Processing batch of 500 companies...
2025-11-04 14:56:52,714 [INFO] __main__: Performing bulk upsert of 500 documents...
2025-11-04 14:56:53,175 [INFO] __main__: MongoDB connection closed.
2025-11-04 14:56:53,177 [INFO] __main__: Script interrupted by user.
2025-11-04 14:57:33,654 [INFO] __main__: ðŸš€ Starting ETL pipeline: company -> employee_trends. Workers=20, BatchSize=1000
2025-11-04 14:57:35,617 [INFO] __main__: âœ… Connected to MongoDB. DB: 'leadcruit'. Source: 'company', Target: 'employee_trends'
2025-11-04 14:57:35,617 [INFO] __main__: Ensuring indexes on target collection 'employee_trends'...
2025-11-04 14:57:37,882 [INFO] __main__: Indexes ensured.
2025-11-04 14:57:37,883 [INFO] __main__: Starting full refresh/upsert from 'company'...
2025-11-04 14:58:00,557 [INFO] __main__: Processing batch of 1000 companies...
2025-11-04 14:58:06,252 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-04 14:58:08,512 [INFO] __main__: âœ… Bulk upsert complete: Inserted=0, Updated=1000
2025-11-04 14:58:16,433 [INFO] __main__: Processing batch of 1000 companies...
2025-11-04 14:58:21,621 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-04 14:58:23,094 [INFO] __main__: âœ… Bulk upsert complete: Inserted=0, Updated=1000
2025-11-04 14:58:29,774 [INFO] __main__: Script interrupted by user.
2025-11-04 14:58:30,118 [ERROR] asyncio: Task exception was never retrieved
future: <Task finished name='Task-1' coro=<main() done, defined at /Users/trentino/Work/RecruitSignalsData/scripts/employee_trends.py:407> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/asyncio/base_events.py", line 629, in run_until_complete
    self.run_forever()
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/asyncio/base_events.py", line 596, in run_forever
    self._run_once()
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/asyncio/base_events.py", line 1854, in _run_once
    event_list = self._selector.select(timeout)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/selectors.py", line 562, in select
    kev_list = self._selector.control(None, max_ev, timeout)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/trentino/Work/RecruitSignalsData/scripts/employee_trends.py", line 343, in run_pipeline
    async for doc in cursor:
  File "/Users/trentino/Library/Python/3.9/lib/python/site-packages/motor/core.py", line 1425, in next
    if self.alive and (self._buffer_size() or await self._get_more()):
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/trentino/Work/RecruitSignalsData/scripts/employee_trends.py", line 447, in <module>
    asyncio.run(main())
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/asyncio/runners.py", line 47, in run
    _cancel_all_tasks(loop)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/asyncio/runners.py", line 63, in _cancel_all_tasks
    loop.run_until_complete(
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/asyncio/base_events.py", line 629, in run_until_complete
    self.run_forever()
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/asyncio/base_events.py", line 596, in run_forever
    self._run_once()
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/asyncio/base_events.py", line 1890, in _run_once
    handle._run()
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/trentino/Work/RecruitSignalsData/scripts/employee_trends.py", line 435, in main
    await pipeline.run_pipeline(args.batch_size, args.workers)
  File "/Users/trentino/Work/RecruitSignalsData/scripts/employee_trends.py", line 404, in run_pipeline
    self.close()
  File "/Users/trentino/Work/RecruitSignalsData/scripts/employee_trends.py", line 260, in close
    self.client.close()
  File "/Users/trentino/Library/Python/3.9/lib/python/site-packages/pymongo/synchronous/mongo_client.py", line 1722, in close
    self._end_sessions(session_ids)
  File "/Users/trentino/Library/Python/3.9/lib/python/site-packages/pymongo/synchronous/mongo_client.py", line 1686, in _end_sessions
    with self._conn_for_reads(
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 117, in __enter__
    return next(self.gen)
  File "/Users/trentino/Library/Python/3.9/lib/python/site-packages/pymongo/synchronous/mongo_client.py", line 1867, in _conn_from_server
    with self._checkout(server, session) as conn:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 117, in __enter__
    return next(self.gen)
  File "/Users/trentino/Library/Python/3.9/lib/python/site-packages/pymongo/synchronous/mongo_client.py", line 1777, in _checkout
    with server.checkout(handler=err_handler) as conn:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 117, in __enter__
    return next(self.gen)
  File "/Users/trentino/Library/Python/3.9/lib/python/site-packages/pymongo/synchronous/pool.py", line 1118, in checkout
    conn = self._get_conn(checkout_started_time, handler=handler)
  File "/Users/trentino/Library/Python/3.9/lib/python/site-packages/pymongo/synchronous/pool.py", line 1280, in _get_conn
    conn = self.connect(handler=handler)
  File "/Users/trentino/Library/Python/3.9/lib/python/site-packages/pymongo/synchronous/pool.py", line 1032, in connect
    networking_interface = _configured_socket_interface(self.address, self.opts)
  File "/Users/trentino/Library/Python/3.9/lib/python/site-packages/pymongo/pool_shared.py", line 496, in _configured_socket_interface
    ssl_sock = ssl_context.wrap_socket(sock, server_hostname=host)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/ssl.py", line 500, in wrap_socket
    return self.sslsocket_class._create(
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/ssl.py", line 1040, in _create
    self.do_handshake()
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/ssl.py", line 1309, in do_handshake
    self._sslobj.do_handshake()
KeyboardInterrupt
2025-11-04 14:59:00,765 [INFO] __main__: ðŸš€ Starting ETL pipeline: company -> employee_trends. Workers=20, BatchSize=1000
2025-11-04 14:59:02,379 [INFO] __main__: âœ… Connected to MongoDB. DB: 'leadcruit'. Source: 'company', Target: 'employee_trends'
2025-11-04 14:59:02,379 [INFO] __main__: Ensuring indexes on target collection 'employee_trends'...
2025-11-04 14:59:03,208 [INFO] __main__: Indexes ensured.
2025-11-04 14:59:03,209 [INFO] __main__: Starting full refresh/upsert from 'company'...
2025-11-04 14:59:25,469 [INFO] __main__: Processing batch of 1000 companies...
2025-11-04 14:59:31,093 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-04 14:59:33,580 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-04 14:59:41,265 [INFO] __main__: Processing batch of 1000 companies...
2025-11-04 14:59:46,415 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-04 14:59:47,791 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-04 15:00:01,121 [INFO] __main__: Processing batch of 1000 companies...
2025-11-04 15:00:06,156 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-04 15:00:07,928 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-04 15:00:19,699 [INFO] __main__: Processing batch of 1000 companies...
2025-11-04 15:00:24,220 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-04 15:00:25,847 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-04 15:00:35,448 [INFO] __main__: Processing batch of 1000 companies...
2025-11-04 15:00:40,749 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-04 15:00:42,385 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-04 15:00:47,776 [INFO] __main__: Processing batch of 1000 companies...
2025-11-04 15:00:50,485 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-04 15:00:52,004 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-04 15:01:05,445 [INFO] __main__: Processing batch of 1000 companies...
2025-11-04 15:01:11,987 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-04 15:01:13,773 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-04 15:01:23,739 [INFO] __main__: Processing batch of 1000 companies...
2025-11-04 15:01:30,297 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-04 15:01:32,166 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-04 15:01:39,920 [INFO] __main__: Processing batch of 1000 companies...
2025-11-04 15:01:44,861 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-04 15:01:46,683 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-04 15:01:51,904 [INFO] __main__: Processing batch of 1000 companies...
2025-11-04 15:01:55,037 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-04 15:01:56,402 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-04 15:02:06,568 [INFO] __main__: Processing batch of 1000 companies...
2025-11-04 15:02:12,610 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-04 15:02:14,389 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-04 15:02:22,512 [INFO] __main__: Processing batch of 1000 companies...
2025-11-04 15:02:28,165 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-04 15:02:29,862 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-04 15:02:37,831 [INFO] __main__: Processing batch of 1000 companies...
2025-11-04 15:02:41,133 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-04 15:02:42,523 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-04 15:02:52,581 [INFO] __main__: Processing batch of 1000 companies...
2025-11-04 15:02:58,402 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-04 15:03:00,224 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-04 15:03:12,213 [INFO] __main__: Processing batch of 1000 companies...
2025-11-04 15:03:18,848 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-04 15:03:20,563 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-04 15:03:26,782 [INFO] __main__: Processing batch of 1000 companies...
2025-11-04 15:03:30,622 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-04 15:03:31,876 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-04 15:03:36,746 [INFO] __main__: Processing batch of 1000 companies...
2025-11-04 15:03:39,215 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-04 15:03:40,685 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-04 15:03:50,444 [INFO] __main__: Processing batch of 1000 companies...
2025-11-04 15:03:56,070 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-04 15:03:57,706 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-04 15:04:07,107 [INFO] __main__: Processing batch of 1000 companies...
2025-11-04 15:04:13,965 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-04 15:04:15,755 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-04 15:04:32,665 [INFO] __main__: Processing batch of 1000 companies...
2025-11-04 15:04:41,654 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-04 15:04:43,464 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-04 15:04:56,553 [INFO] __main__: Processing batch of 1000 companies...
2025-11-04 15:05:03,062 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-04 15:05:04,255 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-04 15:05:19,462 [INFO] __main__: Processing batch of 1000 companies...
2025-11-04 15:05:28,151 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-04 15:05:29,773 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-04 15:05:46,632 [INFO] __main__: Processing batch of 1000 companies...
2025-11-04 15:05:55,074 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-04 15:05:56,811 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-04 15:06:12,563 [INFO] __main__: Processing batch of 1000 companies...
2025-11-04 15:06:19,833 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-04 15:06:22,545 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-04 15:06:49,881 [INFO] __main__: Processing batch of 1000 companies...
2025-11-04 15:06:57,804 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-04 15:07:01,195 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-04 15:07:19,431 [INFO] __main__: Processing batch of 1000 companies...
2025-11-04 15:07:27,117 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-04 15:07:28,639 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-04 15:07:36,992 [INFO] __main__: Processing batch of 1000 companies...
2025-11-04 15:07:40,067 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-04 15:07:41,871 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-04 15:07:48,998 [INFO] __main__: Processing batch of 1000 companies...
2025-11-04 15:07:53,276 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-04 15:07:54,928 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-04 15:08:08,748 [INFO] __main__: Processing batch of 1000 companies...
2025-11-04 15:08:16,482 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-04 15:08:18,257 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-04 15:08:32,476 [INFO] __main__: Processing batch of 1000 companies...
2025-11-04 15:08:40,224 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-04 15:08:41,523 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-04 15:08:55,616 [INFO] __main__: Processing batch of 1000 companies...
2025-11-04 15:09:03,662 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-04 15:09:04,862 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-04 15:09:19,223 [INFO] __main__: Processing batch of 1000 companies...
2025-11-04 15:09:27,407 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-04 15:09:29,033 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-04 15:09:44,864 [INFO] __main__: Processing batch of 1000 companies...
2025-11-04 15:09:53,373 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-04 15:09:54,953 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-04 15:10:11,158 [INFO] __main__: Processing batch of 1000 companies...
2025-11-04 15:10:19,190 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-04 15:10:20,772 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-04 15:10:34,909 [INFO] __main__: Processing batch of 1000 companies...
2025-11-04 15:10:43,543 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-04 15:10:45,118 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-04 15:10:51,282 [INFO] __main__: Processing final batch of 473 companies...
2025-11-04 15:10:51,332 [WARNING] __main__: Skipping doc, missing company_id: 68aed57612cafcf4903a7149
2025-11-04 15:10:51,341 [WARNING] __main__: Skipping doc, missing company_id: 68aed57712cafcf4903a714a
2025-11-04 15:10:55,125 [INFO] __main__: Performing bulk upsert of 471 documents...
2025-11-04 15:10:56,010 [INFO] __main__: âœ… Bulk upsert complete: Inserted=471, Updated=0
2025-11-04 15:10:56,010 [INFO] __main__: âœ… All companies processed. Pipeline complete. Total upserted: 35471
2025-11-04 15:10:56,150 [INFO] __main__: MongoDB connection closed.
2025-11-05 13:41:52,125 [INFO] __main__: ðŸš€ Starting ETL pipeline: company -> employee_trends. Workers=20, BatchSize=1000
2025-11-05 13:41:54,259 [INFO] __main__: âœ… Connected to MongoDB. DB: 'leadcruit'. Source: 'company', Target: 'employee_trends'
2025-11-05 13:41:54,260 [INFO] __main__: Ensuring indexes on target collection 'employee_trends'...
2025-11-05 13:41:57,754 [INFO] __main__: Indexes ensured.
2025-11-05 13:41:57,754 [INFO] __main__: Starting full refresh/upsert from 'company'...
2025-11-05 13:42:08,966 [INFO] __main__: Processing batch of 1000 companies...
2025-11-05 13:42:14,853 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-05 13:42:16,813 [INFO] __main__: âœ… Bulk upsert complete: Inserted=0, Updated=1000
2025-11-05 13:42:25,094 [INFO] __main__: Processing batch of 1000 companies...
2025-11-05 13:42:26,289 [INFO] __main__: Script interrupted by user.
2025-11-05 13:42:39,880 [INFO] __main__: ðŸš€ Starting ETL pipeline: company -> employee_trends. Workers=20, BatchSize=1000
2025-11-05 13:42:41,600 [INFO] __main__: âœ… Connected to MongoDB. DB: 'leadcruit'. Source: 'company', Target: 'employee_trends'
2025-11-05 13:42:41,600 [INFO] __main__: Ensuring indexes on target collection 'employee_trends'...
2025-11-05 13:42:42,429 [INFO] __main__: Indexes ensured.
2025-11-05 13:42:42,429 [INFO] __main__: Starting full refresh/upsert from 'company'...
2025-11-05 13:42:53,340 [INFO] __main__: Processing batch of 1000 companies...
2025-11-05 13:42:59,068 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-05 13:43:01,118 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-05 13:43:08,755 [INFO] __main__: Processing batch of 1000 companies...
2025-11-05 13:43:13,867 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-05 13:43:14,928 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-05 13:43:26,449 [INFO] __main__: Processing batch of 1000 companies...
2025-11-05 13:43:31,555 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-05 13:43:32,603 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-05 13:43:40,013 [INFO] __main__: Processing batch of 1000 companies...
2025-11-05 13:43:44,591 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-05 13:43:45,638 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-05 13:43:53,398 [INFO] __main__: Processing batch of 1000 companies...
2025-11-05 13:43:58,698 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-05 13:43:59,744 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-05 13:44:05,051 [INFO] __main__: Processing batch of 1000 companies...
2025-11-05 13:44:07,718 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-05 13:44:08,621 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-05 13:44:19,940 [INFO] __main__: Processing batch of 1000 companies...
2025-11-05 13:44:26,517 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-05 13:44:27,441 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-05 13:44:36,810 [INFO] __main__: Processing batch of 1000 companies...
2025-11-05 13:44:43,437 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-05 13:44:44,594 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-05 13:44:52,320 [INFO] __main__: Processing batch of 1000 companies...
2025-11-05 13:44:57,260 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-05 13:44:58,360 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-05 13:45:03,632 [INFO] __main__: Processing batch of 1000 companies...
2025-11-05 13:45:06,773 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-05 13:45:08,618 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-05 13:45:18,670 [INFO] __main__: Processing batch of 1000 companies...
2025-11-05 13:45:24,720 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-05 13:45:25,803 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-05 13:45:33,605 [INFO] __main__: Processing batch of 1000 companies...
2025-11-05 13:45:39,242 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-05 13:45:40,267 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-05 13:45:47,220 [INFO] __main__: Processing batch of 1000 companies...
2025-11-05 13:45:50,692 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-05 13:45:51,704 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-05 13:46:02,857 [INFO] __main__: Processing batch of 1000 companies...
2025-11-05 13:46:09,045 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-05 13:46:11,142 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-05 13:46:32,632 [INFO] __main__: Processing batch of 1000 companies...
2025-11-05 13:46:39,205 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-05 13:46:40,590 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-05 13:46:46,120 [INFO] __main__: Processing batch of 1000 companies...
2025-11-05 13:46:50,124 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-05 13:46:51,020 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-05 13:46:56,427 [INFO] __main__: Processing batch of 1000 companies...
2025-11-05 13:46:58,850 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-05 13:46:59,811 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-05 13:47:14,837 [INFO] __main__: Processing batch of 1000 companies...
2025-11-05 13:47:20,249 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-05 13:47:21,463 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-05 13:47:31,465 [INFO] __main__: Processing batch of 1000 companies...
2025-11-05 13:47:37,976 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-05 13:47:39,068 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-05 13:47:56,254 [INFO] __main__: Processing batch of 1000 companies...
2025-11-05 13:48:04,886 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-05 13:48:06,018 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-05 13:48:21,550 [INFO] __main__: Processing batch of 1000 companies...
2025-11-05 13:48:27,706 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-05 13:48:28,844 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-05 13:48:44,781 [INFO] __main__: Processing batch of 1000 companies...
2025-11-05 13:48:53,217 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-05 13:48:54,436 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-05 13:49:09,160 [INFO] __main__: Processing batch of 1000 companies...
2025-11-05 13:49:17,600 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-05 13:49:18,785 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-05 13:49:31,152 [INFO] __main__: Processing batch of 1000 companies...
2025-11-05 13:49:38,449 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-05 13:49:39,616 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-05 13:49:59,014 [INFO] __main__: Processing batch of 1000 companies...
2025-11-05 13:50:06,989 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-05 13:50:08,024 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-05 13:50:23,814 [INFO] __main__: Processing batch of 1000 companies...
2025-11-05 13:50:31,567 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-05 13:50:32,744 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-05 13:50:41,930 [INFO] __main__: Processing batch of 1000 companies...
2025-11-05 13:50:44,960 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-05 13:50:45,794 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-05 13:50:54,512 [INFO] __main__: Processing batch of 1000 companies...
2025-11-05 13:50:58,899 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-05 13:50:59,877 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-05 13:51:14,645 [INFO] __main__: Processing batch of 1000 companies...
2025-11-05 13:51:22,415 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-05 13:51:23,526 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-05 13:51:42,033 [INFO] __main__: Processing batch of 1000 companies...
2025-11-05 13:51:49,820 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-05 13:51:50,985 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-05 13:52:06,469 [INFO] __main__: Processing batch of 1000 companies...
2025-11-05 13:52:14,611 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-05 13:52:15,798 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-05 13:52:33,607 [INFO] __main__: Processing batch of 1000 companies...
2025-11-05 13:52:41,739 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-05 13:52:42,902 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-05 13:53:02,164 [INFO] __main__: Processing batch of 1000 companies...
2025-11-05 13:53:10,727 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-05 13:53:12,310 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-05 13:53:37,799 [INFO] __main__: Processing batch of 1000 companies...
2025-11-05 13:53:45,947 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-05 13:53:47,104 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-05 13:54:03,175 [INFO] __main__: Processing batch of 1000 companies...
2025-11-05 13:54:11,939 [INFO] __main__: Performing bulk upsert of 1000 documents...
2025-11-05 13:54:13,025 [INFO] __main__: âœ… Bulk upsert complete: Inserted=1000, Updated=0
2025-11-05 13:54:20,161 [INFO] __main__: Processing final batch of 473 companies...
2025-11-05 13:54:20,166 [WARNING] __main__: Skipping doc, missing company_id: 68aed57612cafcf4903a7149
2025-11-05 13:54:20,175 [WARNING] __main__: Skipping doc, missing company_id: 68aed57712cafcf4903a714a
2025-11-05 13:54:24,066 [INFO] __main__: Performing bulk upsert of 471 documents...
2025-11-05 13:54:24,815 [INFO] __main__: âœ… Bulk upsert complete: Inserted=471, Updated=0
2025-11-05 13:54:24,815 [INFO] __main__: âœ… All companies processed. Pipeline complete. Total upserted: 35471
2025-11-05 13:54:24,953 [INFO] __main__: MongoDB connection closed.
